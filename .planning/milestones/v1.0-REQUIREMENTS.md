# Requirements Archive: v1.0 MVP

**Archived:** 2026-02-13
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: Arduino-to-MAX Sensor Pipeline

**Defined:** 2026-02-12
**Core Value:** Reliable, lowest-possible-latency delivery of clean sensor data from Arduino to MAX

**Architecture:** Arduino handles the physics (sample, fuse, smooth, send clean values). Node for Max handles the musicianship (calibration, scaling, thresholding, mapping, routing into MAX). Arduino is a reliable, dumb data source. Node is the intelligent interpreter.

## v1 Requirements

All 28 requirements satisfied at milestone completion.

### Arduino Firmware (Physics Layer)

- [x] **ARDU-01**: Arduino reads LSM6DS3 accelerometer and gyroscope at sensor ODR (114.2 Hz measured)
- [x] **ARDU-02**: Arduino runs Madgwick filter on-device to compute stable pitch, roll, and relative yaw
- [x] **ARDU-03**: Arduino applies basic smoothing to fused orientation values before sending
- [x] **ARDU-04**: Arduino sends clean, structured data over USB serial at 57600 baud (newline-delimited CSV)
- [x] **ARDU-05**: Arduino sends both raw 6-axis values and computed orientation in each message
- [x] **ARDU-06**: Madgwick filter sample rate matches actual loop execution rate (measured at 114.2 Hz)

### Serial Communication

- [x] **SERL-01**: Node for Max receives serial data via serialport npm package with ReadlineParser
- [x] **SERL-02**: Node for Max validates incoming data (correct field count, no NaN values) and drops malformed lines
- [x] **SERL-03**: Node for Max outputs parsed data to MAX via tagged maxAPI.outlet() messages
- [x] **SERL-04**: User can see connection status (port detected, data flowing, disconnected) in MAX patch
- [x] **SERL-05**: Pipeline recovers gracefully when Arduino is disconnected and reconnected

### WiFi Transport

- [x] **WIFI-01**: Arduino can send IMU data over WiFi/UDP as alternative to USB serial
- [x] **WIFI-02**: MAX patch can receive wireless IMU data via Node for Max UDP (dgram)
- [x] **WIFI-03**: User can switch between USB serial and WiFi transport without restarting MAX

### Calibration (Node Layer)

- [x] **CALB-01**: User can trigger interactive calibration from MAX (toggle on, hold still, auto-stop at 200 samples)
- [x] **CALB-02**: Node computes and stores gyro bias offsets applied to subsequent readings
- [x] **CALB-03**: User can toggle calibration on/off from MAX without restarting
- [x] **CALB-04**: User can reset calibration to uncalibrated state (zero-offset reset) from MAX
- [x] **CALB-05**: User can reset yaw to zero from MAX at any time
- [x] **CALB-06**: Visual feedback in MAX during calibration (progress bar, status text)

### MAX Integration (Musician's Layer)

- [x] **MAXI-01**: Signal smoothing via configurable parameters reduces sensor noise for downstream use
- [x] **MAXI-02**: Value scaling maps sensor ranges to user-defined parameter ranges with exponential curves
- [x] **MAXI-03**: Threshold/event detection converts continuous orientation into discrete gesture triggers (Phase 6)
- [x] **MAXI-04**: Reusable MAX abstraction (.maxpat) encapsulates entire pipeline with clean inlets/outlets
- [x] **MAXI-05**: Abstraction accepts arguments for configuration (port, smoothing amount)
- [x] **MAXI-06**: 3D orientation visualization renders device orientation in real-time using Jitter (companion patch)
- [x] **MAXI-07**: Quaternion orientation output available alongside Euler angles for 3D work
- [x] **MAXI-08**: Abstraction includes help patch (.maxhelp) documenting usage and outlets

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### Performance Optimization

- **PERF-01**: Binary serial protocol for 400+ Hz sample rates
- **PERF-02**: Configurable LSM6DS3 ODR above 104 Hz via register writes or SparkFun library
- **PERF-03**: Configurable accelerometer range (+/-2g, 4g, 8g, 16g) for different use cases

### Extended Features

- **EXTD-01**: Data recording and playback for offline development without hardware
- **EXTD-02**: OSC output from MAX for interoperability with other creative software
- **EXTD-03**: Axis remapping for different sensor mounting orientations

## Out of Scope

| Feature | Reason |
|---------|--------|
| Absolute yaw/heading | LSM6DS3 has no magnetometer; physically impossible without hardware change |
| Machine learning gesture recognition | ATmega4809 too constrained; do in MAX/Node if needed |
| Multi-board support | Single Arduino pipeline; adding more boards is a different architecture |
| Auto-discovery of serial port | Fragile and platform-specific; user selects from list |
| WiFi configuration UI in MAX | Hard-code WiFi credentials in sketch; keeps scope manageable |
| Kalman filter | Over-engineering for creative applications; Madgwick sufficient |
| Mobile/tablet control | Desktop MAX only |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| ARDU-01 | Phase 1: Arduino Firmware | Complete |
| ARDU-02 | Phase 1: Arduino Firmware | Complete |
| ARDU-03 | Phase 1: Arduino Firmware | Complete |
| ARDU-04 | Phase 1: Arduino Firmware | Complete |
| ARDU-05 | Phase 1: Arduino Firmware | Complete |
| ARDU-06 | Phase 1: Arduino Firmware | Complete |
| SERL-01 | Phase 2: Serial Bridge | Complete |
| SERL-02 | Phase 2: Serial Bridge | Complete |
| SERL-03 | Phase 2: Serial Bridge | Complete |
| SERL-04 | Phase 2: Serial Bridge | Complete |
| SERL-05 | Phase 2: Serial Bridge | Complete |
| WIFI-01 | Phase 5: Abstraction and WiFi | Complete |
| WIFI-02 | Phase 5: Abstraction and WiFi | Complete |
| WIFI-03 | Phase 5: Abstraction and WiFi | Complete |
| CALB-01 | Phase 3: Calibration | Complete |
| CALB-02 | Phase 3: Calibration | Complete |
| CALB-03 | Phase 3: Calibration | Complete |
| CALB-04 | Phase 3: Calibration | Complete |
| CALB-05 | Phase 3: Calibration | Complete |
| CALB-06 | Phase 3: Calibration | Complete |
| MAXI-01 | Phase 4: Musical Tools | Complete |
| MAXI-02 | Phase 4: Musical Tools | Complete |
| MAXI-03 | Phase 6: Threshold Triggers | Complete |
| MAXI-04 | Phase 5: Abstraction and WiFi | Complete |
| MAXI-05 | Phase 5: Abstraction and WiFi | Complete |
| MAXI-06 | Phase 5: Abstraction and WiFi | Complete |
| MAXI-07 | Phase 4: Musical Tools | Complete |
| MAXI-08 | Phase 5: Abstraction and WiFi | Complete |

**Coverage:**
- v1 requirements: 28 total
- Satisfied: 28 (100%)
- Unsatisfied: 0

---
*Requirements defined: 2026-02-12*
*Archived: 2026-02-13 after v1.0 milestone completion*
